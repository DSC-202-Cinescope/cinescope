from flask import Flask, render_template, request, jsonify
import json

app = Flask(__name__)

# Load movie classification data from JSON
with open("random_movies.json", "r", encoding="utf-8") as f:
    MOVIE_CLASSIFICATIONS = json.load(f)

# Convert JSON list into a dictionary for fast lookup
MOVIE_DICT = {movie["title"]: movie["classification"] for movie in MOVIE_CLASSIFICATIONS}

@app.route('/', methods=['GET'])
def home():
    return render_template('index.html', movies_dict=MOVIE_DICT)

@app.route('/get_classification', methods=['POST'])
def get_classification():
    data = request.json
    movie_title = data.get("title", "")

    # Get classification, return "Unknown" if not found
    classification = MOVIE_DICT.get(movie_title, "Unknown")

    return jsonify({"classification": classification})

if __name__ == "__main__":
    app.run(host="0.0.0.0", port=8080)